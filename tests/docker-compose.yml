version: "3.7"

services:
  postgres:
    image: "postgres:alpine"
    restart: always
    environment:
    - POSTGRES_USER=dbhub
    - POSTGRES_PASSWORD=changeit
    - POSTGRES_DB=dbhub
  memcached:
    image: "memcached:alpine"
    restart: always
  minio:
    image: "minio/minio"
    restart: always
    environment:
    - MINIO_ACCESS_KEY=changeit
    - MINIO_SECRET_KEY=changeit
  dbhub:
    # Pass the build id image via env variable
    environment:
    - BUILD_ID=${BUILD_ID}
    image: "dbhubtest:${BUILD_ID}"
